<div class="modal" *ngIf="isOpen">
  <div class="modal-content">
    <span class="close" (click)="closeModal()">&times;</span>

    <ng-container *ngIf="membershipStatus === 'inactive'">
      <h1>{{ isPortuguese ? 'Assine agora' : 'Subscribe now' }}</h1>
      <p>{{ isPortuguese ? 'Escolha uma opção de assinatura para obter acesso total' : 'Choose a subscription option to unlock all features' }}</p>

      <div class="flexModal" *ngIf="availablePackages.length > 0; else loadingOrError">
        <div class="modalPrices" *ngFor="let pkg of availablePackages">
          <h2>{{ formatTitle(pkg.product.title) }}</h2>
          <h3>{{ formatPrice(pkg.product.priceString) }}</h3>
          <p>{{ formatSubscriptionPeriod(pkg.product.subscriptionPeriod || '') }}</p>
          <input type="radio" name="subscriptionOption" [value]="pkg" (change)="selectPackage(pkg)" />
        </div>
      </div>

      <ng-template #loadingOrError>
        <p *ngIf="isLoading">
          <ion-spinner name="crescent"></ion-spinner>
          {{ isPortuguese ? 'Carregando planos...' : 'Loading plans...' }}
        </p>
        <p *ngIf="!isLoading && availablePackages.length === 0">
          {{ isPortuguese ? 'Não foi possível carregar planos de assinatura.' : 'Unable to load subscription plans.' }}
        </p>
        <button (click)="fetchOfferings()">{{ isPortuguese ? 'Tentar novamente' : 'Retry' }}</button>
      </ng-template>

      <ul class="ulManage">{{ isPortuguese ? 'Programa Briza Personalizado' : 'Personalized Briza Program' }}</ul>
      <ul class="ulManage">{{ isPortuguese ? 'Técnicas de respiração personalizáveis' : 'Customizable breathing techniques' }}</ul>
      <ul class="ulManage">{{ isPortuguese ? 'Resultados para acompanhar seu progresso' : 'Results to track your progress' }}</ul>
      <ul class="ulManage">{{ isPortuguese ? 'Técnicas de retenção de respiração' : 'Breath Holding Techniques' }}</ul>
      <ul class="ulManage">{{ isPortuguese ? 'Técnicas de Pranayama' : 'Pranayama Techniques' }}</ul>

      <button (click)="subscribe()" type="button" [disabled]="isLoading" class="manageSubmit">
        <span *ngIf="!isLoading">{{ isPortuguese ? 'Assine Agora' : 'Subscribe Now' }}</span>
        <ion-spinner *ngIf="isLoading" name="crescent"></ion-spinner>
      </button>

      <p class="manageSubsModal">
        {{
          isPortuguese
            ? 'Sua assinatura começa assim que você configura o pagamento. Sua cobrança automática mensal/anual ocorrerá no último dia do período de faturamento atual. Nós renovaremos sua assinatura para você (a menos que você tenha cancelado sua assinatura na página de perfil 24 horas antes do final do ciclo de faturamento)'
            : 'Your membership starts as soon as you set up payment. Your monthly/yearly auto-renew charge will occur on the last day of the current billing period. We will renew your membership for you (unless you have canceled your subscription in the profile page 24 hours before end of billing cycle)'
        }}
      </p>
    </ng-container>
  </div>
</div>
